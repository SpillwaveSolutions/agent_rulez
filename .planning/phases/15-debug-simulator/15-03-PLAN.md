# Plan 15-03: Integration Wiring + E2E Test Fixes

## Objective
Wire `window.__rulezMockDebugResponse` into the browser mock, ensure full flow works end-to-end, and fix E2E tests that reference missing UI elements.

## Tasks

### Task 1: Wire mock injection into mockRunDebug
**File:** `rulez_ui/src/lib/tauri.ts`
- In `mockRunDebug()`, check `window.__rulezMockDebugResponse` first
- If set, return it (with delay) instead of hardcoded mock
- This allows E2E tests to inject specific responses

### Task 2: Update E2E tests for save/load buttons
**File:** `rulez_ui/tests/simulator.spec.ts`
- Test 8 (save test case): Run a simulation first, then click save, verify success message
- Test 9 (load test case): Save a case first, then click load, verify form is populated
- Use `mockBinaryResponse()` from test utils for deterministic responses

### Task 3: Add __rulezMockDebugResponse type declaration
**File:** `rulez_ui/src/lib/tauri.ts`
- Add Window interface augmentation for `__rulezMockDebugResponse`
- Ensure TypeScript knows about the global

### Task 4: Build verification
- Run `npx tsc --noEmit` in `rulez_ui`
- Run `npx biome check --write` on all changed files
- Run `cd rulez_ui && npm run build` to verify Vite build succeeds
- Run `cargo check` in `cch_cli` to verify Rust changes compile

## Verification
- Full Vite build succeeds
- TypeScript check passes
- E2E tests 1-10 in `simulator.spec.ts` have valid selectors
- `mockBinaryResponse()` can inject custom responses into the app

## Files Changed
- `rulez_ui/src/lib/tauri.ts`
- `rulez_ui/tests/simulator.spec.ts`
