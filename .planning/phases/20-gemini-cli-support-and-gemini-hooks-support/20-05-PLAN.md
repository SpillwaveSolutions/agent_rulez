---
phase: 20-gemini-cli-support-and-gemini-hooks-support
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - cch_cli/src/cli/gemini_doctor.rs
  - cch_cli/tests/gemini_doctor.rs
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Diagnostics output includes a docs reference or remediation hint when outdated cch hook commands are detected."
  artifacts:
    - path: "cch_cli/src/cli/gemini_doctor.rs"
      provides: "Outdated cch command diagnostics messaging with docs/remediation hint"
      contains: "GEMINI_CLI_HOOKS"
    - path: "cch_cli/tests/gemini_doctor.rs"
      provides: "Coverage for outdated cch diagnostics messaging"
      contains: "outdated"
  key_links:
    - from: "cch_cli/src/cli/gemini_doctor.rs"
      to: "docs/GEMINI_CLI_HOOKS.md"
      via: "details strings emitted in doctor report"
      pattern: "GEMINI_CLI_HOOKS"
---

<objective>
Add explicit remediation guidance to Gemini doctor warnings for outdated cch hook commands.

Purpose: Close the diagnostic gap so users see where to fix outdated hook commands.
Output: Updated diagnostics messaging and tests that assert the guidance.
</objective>

<execution_context>
@/Users/richardhightower/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/richardhightower/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/20-gemini-cli-support-and-gemini-hooks-support/20-VERIFICATION.md
@cch_cli/src/cli/gemini_doctor.rs
@cch_cli/tests/gemini_doctor.rs
@docs/GEMINI_CLI_HOOKS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add docs/remediation hint to outdated cch diagnostics</name>
  <files>cch_cli/src/cli/gemini_doctor.rs</files>
  <action>
Update the outdated-cch details strings so they include a docs reference or remediation hint. Ensure both scope diagnostics and extension/shared hook diagnostics add the hint when outdated commands are detected (including the "binary may be outdated" branch and the "Found X outdated" branch). Keep the hint concise and ASCII-only, and include a direct reference to `docs/GEMINI_CLI_HOOKS.md` and the recommended fix (for example, "run `cch gemini install`"). This hint must be present in both JSON `details` output and human-readable output (which uses the same details field).
  </action>
  <verify>cargo test -p cch_cli gemini_doctor</verify>
  <done>Outdated cch diagnostics include a docs/remediation hint in details for scopes and hook files.</done>
</task>

<task type="auto">
  <name>Task 2: Extend Gemini doctor tests for outdated guidance</name>
  <files>cch_cli/tests/gemini_doctor.rs</files>
  <action>
Add test coverage that triggers the outdated command path (use a cch command without "gemini hook"), then assert the JSON `details` field includes the docs reference or remediation hint for at least one scope and one hook file entry. Keep existing assertions intact; add minimal fixture changes or an additional test to isolate the outdated branch.
  </action>
  <verify>cargo test -p cch_cli gemini_doctor</verify>
  <done>Tests fail without the hint and pass when the outdated diagnostics include docs/remediation guidance.</done>
</task>

</tasks>

<verification>
- `cargo test -p cch_cli gemini_doctor`
</verification>

<success_criteria>
- `cch gemini doctor` JSON and human output show a docs/remediation hint whenever outdated cch hook commands are detected.
- Tests assert the hint for both scope settings and hook file diagnostics.
</success_criteria>

<output>
After completion, create `.planning/phases/20-gemini-cli-support-and-gemini-hooks-support/20-05-SUMMARY.md`
</output>
